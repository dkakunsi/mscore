trigger:
  branches:
    exclude:
      - master
  paths:
    include:
      - mscore/workflow/**
    exclude:
      - mscore/workflow/README.MD
      - mscore/workflow/azure-pipelines*

pool:
  vmImage: ubuntu-latest

steps:
  # used for mscore profile
  # - task: MavenAuthenticate@0
  #   displayName: 'Maven Authenticate'
  #   inputs:
  #     artifactsFeeds: mscore

  # used for myMavenRepo profile
  - task: DownloadSecureFile@1
    displayName: "Download maven settings file"
    name: "mavenSettingsFile"
    inputs:
      secureFile: "settings.xml"

  - task: Maven@3
    displayName: "Maven build"
    inputs:
      mavenPomFile: "mscore/workflow/pom.xml"
      mavenOptions: "-Xmx3072m"
      javaHomeOption: "JDKVersion"
      jdkVersionOption: "1.11"
      jdkArchitectureOption: "x64"
      publishJUnitResults: true
      testResultsFiles: "mscore/workflow/**/surefire-reports/TEST-*.xml"
      goals: "install"
      #    options: -Drevision=$(Build.BuildNumber) -Pmscore
      options: -Drevision=$(Build.BuildNumber) -PmyMavenRepo
